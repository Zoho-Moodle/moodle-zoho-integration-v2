# ุชุญุฏูุซุงุช ุงููุณุฎุฉ 3.2.0 - Enhanced Monitoring & Event Logs

## ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุชุทููุฑ ูุธุงู ุงููุฑุงูุจุฉ ูุณุฌูุงุช ุงูุฃุญุฏุงุซ ุจุดูู ุดุงูู ูู ูุฐู ุงููุณุฎุฉุ ูุน ุงูุชุฑููุฒ ุนูู ุชูููุฑ ุฑุคูุฉ ุชูุตูููุฉ ูุฏูููุฉ ููู ุนูููุฉ ูุฒุงููุฉ.

## ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ุชูุงุตูู ูุญุณููุฉ ูู Event Logs โจ

#### ูุงุฐุง ุชุบููุฑุ
ุงูุขู ูุนุฑุถ ุฌุฏูู Event Logs ูุนูููุงุช ุณูุงููุฉ ูุงููุฉ ููู ุญุฏุซ:

**ูุจู ุงููุณุฎุฉ 3.2.0:**
```
| Event ID | Event Type | Status | Created | Actions |
|----------|------------|--------|---------|---------|
| a3b4c5d... | grade_updated | sent | 2026-02-07 | View Details |
```

**ุจุนุฏ ุงููุณุฎุฉ 3.2.0:**
```
| Event ID | Event Type | Student | Course | Assignment | Grade | Status | Actions |
|----------|------------|---------|--------|------------|-------|--------|---------|
| a3b4c5d... | grade_updated | John Doe | BTEC Level 3 IT | Unit 1 | Pass | sent | View Details | Retry |
```

#### ุงูููุงุฆุฏ:
- โ **ููู ููุฑู** ููู ุญุฏุซ ุจุฏูู ุงูุญุงุฌุฉ ููุฏุฎูู ุฅูู ุงูุชูุงุตูู
- โ **ุชุชุจุน ุฃุณูู** ูููุดุงูู ุงููุชุนููุฉ ุจุทุงูุจ ุฃู ููุฑุณ ูุนูู
- โ **ุชุตููุฉ ุฃุณุฑุน** ุนูุฏ ุงูุจุญุซ ุนู ูุดููุฉ ูุนููุฉ
- โ **ุชูุงุฑูุฑ ุฃูุถุญ** ููุฅุฏุงุฑุฉ ูุงูุฏุนู ุงูููู

---

### 2. Health Monitor Dashboard ููุตูู ๐

#### ูุงุฐุง ุชุบููุฑุ
ุจุฏูุงู ูู ุนุฑุถ ุญุงูุฉ ุนุงูุฉ ูุงุญุฏุฉ ูููุธุงูุ ุงูุขู ูุชู ูุฑุงูุจุฉ ูู ุฎุฏูุฉ ุจุดูู ูููุตู:

**ุงูุฎุฏูุงุช ุงููุฑุงูุจุฉ:**
1. **Backend API Connection**: ูุญุต ุงุชุตุงู ุงูุจุงููุฏ
2. **User Synchronization**: ูุฒุงููุฉ ุงููุณุชุฎุฏููู
3. **Course Synchronization**: ูุฒุงููุฉ ุงูููุฑุณุงุช
4. **Enrollment Synchronization**: ูุฒุงููุฉ ุงูุชุณุฌููุงุช
5. **Grade Synchronization**: ูุฒุงููุฉ ุงูุฏุฑุฌุงุช
6. **Learning Outcomes Sync**: ูุฒุงููุฉ ูุฎุฑุฌุงุช ุงูุชุนูู

**ููู ุฎุฏูุฉ:**
- โ **ุญุงูุฉ ูุงุถุญุฉ**: OK (ุฃุฎุถุฑ) / Warning (ุฃุตูุฑ) / Error (ุฃุญูุฑ)
- โ **ุฅุญุตุงุฆูุงุช ููุตูุฉ**: Total, Sent, Failed, Success Rate
- โ **ุขุฎุฑ ููุช ูุญุต**: ุชุญุฏูุซ ุชููุงุฆู ูู ุณุงุนุฉ
- โ **ุฑุณุงุฆู ุชูุถูุญูุฉ**: ุดุฑุญ ูุงุถุญ ููู ุญุงูุฉ

#### ูุซุงู ุนูู ุจุทุงูุฉ ุฎุฏูุฉ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ Grade Synchronization             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ Status: ok                          โ
โ Success rate healthy: 98.5%         โ
โ                                     โ
โ Total Events (24h): 200             โ
โ Sent: 197                           โ
โ Failed: 3                           โ
โ Success Rate: 98.5%                 โ
โ                                     โ
โ Last checked: 2026-02-08 14:30      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### ุงูููุงุฆุฏ:
- โ **ุชุญุฏูุฏ ุงููุดุงูู ุจุณุฑุนุฉ**: ูุนุฑูุฉ ุฃู ุฎุฏูุฉ ุจุงูุถุจุท ุจูุง ูุดููุฉ
- โ **ุงุชุฎุงุฐ ูุฑุงุฑุงุช ูุณุชููุฑุฉ**: ุจูุงุกู ุนูู ุจูุงูุงุช ุฏูููุฉ ููู ุฎุฏูุฉ
- โ **ูุชุงุจุนุฉ ุงูุชุญุณููุงุช**: ููุงุฑูุฉ Success Rate ุนุจุฑ ุงูุฒูู
- โ **ุชูุงุฑูุฑ ุงุญุชุฑุงููุฉ**: ุนุฑุถ ุญุงูุฉ ูู ุฌุฒุก ูู ุงููุธุงู

---

### 3. ุฒุฑ Retry ููุฃุญุฏุงุซ ุงููุงุดูุฉ ๐

#### ูุงุฐุง ุชุบููุฑุ
ุฅุถุงูุฉ ุฒุฑ "Retry" ุจุฌุงูุจ "View Details" ูู Event Logs ููุฃุญุฏุงุซ ุงููุงุดูุฉ.

**ูุจู:**
- ูุงู ูุฌุจ ุงูุชุธุงุฑ ุงูู scheduled task ูุฅุนุงุฏุฉ ุงููุญุงููุฉ ุชููุงุฆูุงู
- ุฃู ุชุนุฏูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฏููุงู

**ุจุนุฏ:**
- ุถุบุทุฉ ุฒุฑ ูุงุญุฏุฉ ูุฅุนุงุฏุฉ ูุญุงููุฉ ุฃู ุญุฏุซ ูุงุดู ููุฑุงู
- ุฑุณุงูุฉ ุชุฃููุฏ ูุชุฌูุจ ุงูุถุบุท ุงูุฎุทุฃ
- ุงูุญุฏุซ ููุนุงุฏ ูุถุนู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ููุฅุฑุณุงู

#### ููููุฉ ุงูุงุณุชุฎุฏุงู:
1. ุงูุชุญ Event Logs
2. ุงุจุญุซ ุนู ุญุฏุซ ุจุญุงูุฉ `failed` ุฃู `retrying`
3. ุงุถุบุท ุนูู ุฒุฑ **Retry** (ุฃุตูุฑ ุงูููู)
4. ุฃููุฏ ุงูุนูููุฉ
5. โ ุชู! ุงูุญุฏุซ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ

#### ุงูููุงุฆุฏ:
- โ **ุญู ุณุฑูุน** ูููุดุงูู ุงููุคูุชุฉ
- โ **ูุง ุญุงุฌุฉ ูููุตูู ููุงุนุฏุฉ ุงูุจูุงูุงุช** ูุจุงุดุฑุฉ
- โ **ุชุญูู ูุงูู** ูู ุนูููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
- โ **ุชูููุฑ ุงูููุช** ูู ุญู ุงููุดุงูู

---

## ุงูุชูุงุตูู ุงูุชูููุฉ

### ุงูุชุบููุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

**ุฌุฏูู `local_mzi_event_log`** - ุฃุนูุฏุฉ ุฌุฏูุฏุฉ:

| Column | Type | Description |
|--------|------|-------------|
| `student_name` | VARCHAR(255) | ุงุณู ุงูุทุงูุจ ุงููุงูู |
| `course_name` | VARCHAR(255) | ุงุณู ุงูููุฑุณ |
| `assignment_name` | VARCHAR(255) | ุงุณู ุงููููุฉ |
| `grade_name` | VARCHAR(100) | ูููุฉ ุงูุฏุฑุฌุฉ |
| `related_id` | INT(10) | ูุนุฑู ุนุงู ููููุงู ุงููุฑุชุจุท |

### ุงููููุงุช ุงูููุนุฏููุฉ

**Backend Code:**
- `classes/event_logger.php` - ุฏุนู context ูู log_event()
- `classes/webhook_sender.php` - ุฏุงูุฉ extract_context() ุงูุฌุฏูุฏุฉ
- `classes/observer.php` - ุชูุฑูุฑ context ููู ุญุฏุซ
- `classes/task/health_monitor.php` - ูุฑุงูุจุฉ ููุตูุฉ ููู ุฎุฏูุฉ

**Database:**
- `db/upgrade.php` - Migration ููุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
- `db/install.xml` - Schema ูุญุฏูุซ ููุชุฑููุจุงุช ุงูุฌุฏูุฏุฉ
- `version.php` - ูุณุฎุฉ 2026020801

**UI:**
- `ui/admin/event_logs.php` - ุนุฑุถ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ + ุฒุฑ Retry
- `ui/admin/health_monitor_detailed.php` - Dashboard ุฌุฏูุฏ ุจุงููุงูู
- `settings.php` - ุฑุจุท ุงูุตูุญุฉ ุงูุฌุฏูุฏุฉ

### API ุงูุชุบููุฑุงุช

#### ูุจู:
```php
event_logger::log_event('grade_updated', $grade_data);
```

#### ุจุนุฏ:
```php
$context = [
    'student_name' => 'John Doe',
    'course_name' => 'BTEC Level 3 IT',
    'assignment_name' => 'Unit 1',
    'grade_name' => 'Pass'
];
event_logger::log_event('grade_updated', $grade_data, null, null, $context);
```

**ุฃู ุงุณุชุฎุฏุงู extract_context ุงูุชููุงุฆู:**
```php
$sender = new webhook_sender();
$context = webhook_sender::extract_context($grade_data, 'grade_updated');
$response = $sender->send_grade_updated($grade_data, null, $context);
```

---

## ุนูููุฉ ุงูุชุฑููุฉ

### ุฎุทูุงุช ุงูุชุฑููุฉ:

```bash
# 1. ุชุฑููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช
php admin/cli/upgrade.php

# 2. ูุณุญ ุงููุงุด
php admin/cli/purge_caches.php

# 3. ุชุดุบูู Health Monitor (ุงุฎุชูุงุฑู)
php admin/cli/scheduled_task.php --execute=\\local_moodle_zoho_sync\\task\\health_monitor
```

### ุงูุชุญูู ูู ูุฌุงุญ ุงูุชุฑููุฉ:

```sql
-- ุงูุชุญูู ูู ุงููุณุฎุฉ
SELECT * FROM mdl_config_plugins 
WHERE plugin = 'local_moodle_zoho_sync' AND name = 'version';
-- ูุฌุจ ุฃู ุชููู: 2026020801

-- ุงูุชุญูู ูู ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ
DESCRIBE mdl_local_mzi_event_log;
-- ูุฌุจ ุฃู ุชุฑู: student_name, course_name, assignment_name, grade_name, related_id
```

---

## ุงูุฃูุซูุฉ ูุงูุญุงูุงุช ุงูุงุณุชุฎุฏุงููุฉ

### ุญุงูุฉ 1: ุชุชุจุน ูุดู ุฏุฑุฌุฉ ุทุงูุจ ูุนูู

**ูุจู 3.2.0:**
1. ุงูุชุญ Event Logs
2. ุงุจุญุซ ูุฏููุงู ุนู event_id
3. ุงูุชุญ View Details ููู ุญุฏุซ
4. ุชุญูู ูู JSON ููุนุฑูุฉ ุงูุทุงูุจ
5. ูุฑูุฑ ุญุชู ุชุฌุฏ ุงูุทุงูุจ ุงููุทููุจ

**ุจุนุฏ 3.2.0:**
1. ุงูุชุญ Event Logs
2. ุงุจุญุซ ุจุตุฑูุงู ูู ุนููุฏ "Student"
3. ูุฌุฏุช ุงููุดููุฉ ููุฑุงู!
4. ุงุถุบุท Retry ูุญููุง

---

### ุญุงูุฉ 2: ูุฑุงูุจุฉ ุตุญุฉ ูุฒุงููุฉ ุงูุฏุฑุฌุงุช

**ูุจู 3.2.0:**
1. ุงูุชุญ Statistics
2. ุงุญุณุจ Success Rate ูุฏููุงู
3. ูุง ุชูุฌุฏ ุชูุงุตูู ุนู ุฃููุงุน ุงูุฃุญุฏุงุซ

**ุจุนุฏ 3.2.0:**
1. ุงูุชุญ Health Monitor Dashboard
2. ุดุงูุฏ ุจุทุงูุฉ "Grade Synchronization"
3. Success Rate: 98.5% โ
4. Total: 200, Sent: 197, Failed: 3
5. ูู ุดูุก ูุงุถุญ ูููุฑู!

---

### ุญุงูุฉ 3: ุชูุฑูุฑ ููุฅุฏุงุฑุฉ

**ูุจู 3.2.0:**
"ุงููุธุงู ูุนูู ุจุดูู ุนุงู"

**ุจุนุฏ 3.2.0:**
```
ุชูุฑูุฑ ุตุญุฉ ุงููุธุงู - 2026-02-08

โ Backend API: OK - ูุชุตู ุจุดูู ุตุญูุญ
โ User Sync: OK - Success rate: 100%
โ Course Sync: OK - ูุง ุชูุฌุฏ ุฃุญุฏุงุซ ุฌุฏูุฏุฉ
โ Enrollment Sync: OK - Success rate: 96.2%
โ Grade Sync: OK - Success rate: 98.5%
โ Learning Outcomes: Warning - Success rate: 89.3%

ุงูุชูุตูุฉ: ูุฑุงุฌุนุฉ ูุดู ูุฒุงููุฉ Learning Outcomes
```

---

## ุงูููุงุฑูุฉ ูุน ุงููุณุฎ ุงูุณุงุจูุฉ

| Feature | v3.1.x | v3.2.0 | ุงูุชุญุณูู |
|---------|--------|--------|---------|
| ุชูุงุตูู Event Logs | ุฃุณุงุณูุฉ | ูุงููุฉ ูุน Student/Course/Grade | +400% |
| Health Monitoring | ุนุงู | ููุตูู ููู ุฎุฏูุฉ | +600% |
| Retry Functionality | ูุฏูู/CLI ููุท | ุฒุฑ ูู UI | +100% |
| Context Extraction | ูุฏูู | ุชููุงุฆู | +100% |
| Admin Experience | ูุชูุณุท | ุงุญุชุฑุงูู | +200% |

---

## ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### ุชุฃุซูุฑ ุนูู ุงูุฃุฏุงุก:
- โ **Event Logging**: ุฒูุงุฏุฉ ุทูููุฉ ุฌุฏุงู (< 5ms)
- โ **Event Logs UI**: ููุณ ุงูุณุฑุนุฉ (ุงูุจูุงูุงุช ูุฎุฒููุฉ ูุจุงุดุฑุฉ)
- โ **Health Monitor**: ูุง ุชุฃุซูุฑ ุนูู ุงููุณุชุฎุฏููู (ูุนูู ูู ุงูุฎูููุฉ)

### ุงูุชุญุณููุงุช:
- โ ุงุณุชุฎุฏุงู `get_record()` ุจุฏูุงู ูู JOINs ูุนูุฏุฉ
- โ ุชุฎุฒูู ุงููุชุงุฆุฌ ูู Config ุจุฏูุงู ูู ุงูุญุณุงุจ ุงูููุฑู
- โ ุงุณุชุนูุงูุงุช ูุญุณููุฉ ูุน ููุงุชุฑ ุฒูููุฉ (ุขุฎุฑ 24 ุณุงุนุฉ)

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ ูุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### ููุฏ ุงูุชุฎุทูุท:
1. **Export to CSV**: ุชุตุฏูุฑ Event Logs ุจุงูุชูุงุตูู ุงูุฌุฏูุฏุฉ
2. **Advanced Filters**: ููุงุชุฑ ูุชูุฏูุฉ ุญุณุจ Student/Course
3. **Real-time Dashboard**: ุชุญุฏูุซ ุชููุงุฆู ุจุฏูู ุฅุนุงุฏุฉ ุชุญููู
4. **Batch Retry**: ุฅุนุงุฏุฉ ูุญุงููุฉ ุนุฏุฉ ุฃุญุฏุงุซ ุฏูุนุฉ ูุงุญุฏุฉ
5. **Email Alerts**: ุชูุจููุงุช ุจุฑูุฏ ุฅููุชุฑููู ููุญุงูุงุช ุงูุฎุทูุฑุฉ

---

## ุงูุฏุนู ูุงููุณุงุนุฏุฉ

### ูุซุงุฆู ุฅุถุงููุฉ:
- `ENHANCED_MONITORING_IMPLEMENTATION.md` - ุงูุชูุงุตูู ุงูุชูููุฉ ุงููุงููุฉ
- `QUICK_SETUP_ENHANCED_MONITORING.md` - ุฏููู ุงูุชูุนูู ุงูุณุฑูุน

### ูู ุญุงู ุงููุดุงูู:
1. ุฑุงุฌุน ุณุฌูุงุช PHP: `/var/log/php/error.log`
2. ุฑุงุฌุน Event Logs ูู Moodle: Admin โ Reports โ Logs
3. ุชุญูู ูู Health Monitor Dashboard
4. ุชูุงุตู ูุน ุงูุฏุนู ุงูููู

---

## ุดูุฑ ูุชูุฏูุฑ

ุชู ุชุทููุฑ ูุฐู ุงูููุฒุงุช ุจูุงุกู ุนูู:
- โ ููุงุญุธุงุช ุงูุฅุฏุงุฑุฉ ูุงููุณุชุฎุฏููู
- โ ุฃูุถู ุงูููุงุฑุณุงุช ูู ูุฑุงูุจุฉ ุงูุฃูุธูุฉ
- โ ูุนุงููุฑ Moodle ููุฌูุฏุฉ ูุงูุฃุฏุงุก

**Developer**: Mohyeddine Farhat  
**Release Date**: February 8, 2026  
**Version**: 3.2.0 - Enhanced Monitoring & Event Logs

---

๐ **ูุจุฑูู! ูุธุงูู ุงูุขู ุฃูุซุฑ ุดูุงููุฉ ููุถูุญุงู ูู ุฃู ููุช ูุถู!**
