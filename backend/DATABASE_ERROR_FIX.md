# โ ุฎุทุฃ ูุงุนุฏุฉ ุงูุจูุงูุงุช - Database Error

## ุงููุดููุฉ

```
UndefinedColumn: column students.username does not exist
```

---

## ุงูุณุจุจ

ุฌุฏูู `students` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช **ูู ูุชู ุชุญุฏูุซู** ููุทุงุจู ุงููููุฐุฌ ุงูุฌุฏูุฏ (`Student` model).

### ุงููุฑู:

| ุงูุญูู | ุงููููุฐุฌ ุงูุฌุฏูุฏ | ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ |
|------|----------------|----------------------|
| `username` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |
| `display_name` | โ ููุฌูุฏ | โ ูุฏ ูููู ุบูุฑ ููุฌูุฏ |
| `moodle_userid` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |
| `fingerprint` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |
| `last_sync` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |
| `created_at` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |
| `updated_at` | โ ููุฌูุฏ | โ ุบูุฑ ููุฌูุฏ |

---

## โ ุงูุญู ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุฃุฏุงุฉ ุงูุฅุนุฏุงุฏ

```bash
cd backend
python setup_db.py
```

ูุฐุง ุณูููู ุจู:
- ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฅุถุงูุฉ ุงูุญููู ุงููุงูุตุฉ
- ุฅูุดุงุก ุงูู indexes

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุฑ ุงูุฎุงุฏู

```bash
python -m uvicorn app.main:app --host 127.0.0.1 --port 8001
```

### ุงูุฎุทูุฉ 3: ุฃุฑุณู ุทูุจ Test

```bash
curl -X POST http://127.0.0.1:8001/v1/sync/students \
  -H "Content-Type: application/json" \
  -d '{
    "records": [{
      "id": "test_123",
      "Name": "ุงุฎุชุจุงุฑ",
      "Academic_Email": "test@example.com"
    }]
  }'
```

---

## ๐ง ุงูุจุฏุงุฆู

### ุงูุจุฏูู 1: ุงุณุชุฎุฏุงู psql ูุจุงุดุฑุฉ

```bash
psql -U admin -d moodle_zoho
```

ุซู ุงูุณุฎ ูุฃูุตู ุงูุฃูุงูุฑ ูู `DATABASE_MIGRATION.sql`

### ุงูุจุฏูู 2: ุงุณุชุฎุฏุงู Python script

```bash
python migrate_db.py
```

---

## ๐ ุงููููุงุช ุฐุงุช ุงูุตูุฉ

- `DATABASE_SETUP.md` - ุดุฑุญ ููุตู ูููุดููุฉ
- `DATABASE_MIGRATION.sql` - ุฃูุงูุฑ SQL ุฌุงูุฒุฉ
- `setup_db.py` - ุฃุฏุงุฉ ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู
- `migrate_db.py` - script ุงูู migration

---

## โ๏ธ ููุงุท ูููุฉ

1. **ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ**: ุฅุฐุง ูุงู ูุฏูู ุจูุงูุงุช ููุฌูุฏุฉ ูู ุงูุฌุฏููุ ุงุณุชุฎุฏู `ALTER TABLE` ูุฅุถุงูุฉ ุงูุญููู ููุท
2. **ุงูุจูุงูุงุช ุงูููููุฏุฉ**: ุฅุฐุง ุฃุฑุฏุช ุญุฐู ูู ุดูุก ูุฅุนุงุฏุฉ ุงูุจุฏุกุ ุงุณุชุฎุฏู `DROP TABLE`
3. **ุงูู indexes**: ุถุฑูุฑูุฉ ููุฃุฏุงุก ุงูุฌูุฏ

---

## โจ ุจุนุฏ ุงูุฅุตูุงุญ

ุณูุนูู ูู ุดูุก ุจุฏูู ูุดุงูู! โ

```
Status: NEW / UNCHANGED / UPDATED / INVALID / ERROR โ
Database: ูุนูู ุจุฏูู ุฃุฎุทุงุก โ
Validation: ููุนูู โ
```

---

**ุงุชุจุน ุงูุฎุทูุงุช ุฃุนูุงู ูุณุชูุชูู ุงููุดููุฉ! ๐**
